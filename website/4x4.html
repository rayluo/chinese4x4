<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <!-- Fontawesome CSS required by the loader -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <title>Chinese 4x4 Learning</title>
  </head>
  <style>
    #cards, td.char {
      font-size: 6vw;
    }
    td.def, td.pinyin {
      font-size: 1.7em;
    }
    td.char {
      height: 1.7em;
      width: 1.2em;
    }
    body {
      font-family: "Georgia", "Times New Roman", "KaiTi", "STKaiti", "serif";
    }
  </style>
  <body id="body" onload="brython()" class="container">
    <div class="container">
      <div class="row">
        <div class="col-4">
          <h2>Unused characters:</h2>
          <div id="cards"></div>
        </div>
        <div class="col-8">
          <table class="table table-bordered" id="table">
            <tbody>
              <tr>
                <td class="char" id="11"></td> <!--id format: [row #][col #]-->
                <td class="char" id="12"></td>
                <td class="char" id="13"></td>
                <td class="char" id="14"></td>
                <td><button onclick="readAloud(1)">ðŸ”‰</button></td>
                <td class="pinyin"></td>
                <td class="def"></td>
              </tr>
              <tr>
                <td class="char" id="21"></td>
                <td class="char" id="22"></td>
                <td class="char" id="23"></td>
                <td class="char" id="24"></td>
                <td><button onclick="readAloud(2)">ðŸ”‰</button></td>
                <td class="pinyin"></td>
                <td class="def"></td>
              </tr>
              <tr>
                <td class="char" id="31"></td>
                <td class="char" id="32"></td>
                <td class="char" id="33"></td>
                <td class="char" id="34"></td>
                <td><button onclick="readAloud(3)">ðŸ”‰</button></td>
                <td class="pinyin"></td>
                <td class="def"></td>
              </tr>
              <tr>
                <td class="char" id="41"></td>
                <td class="char" id="42"></td>
                <td class="char" id="43"></td>
                <td class="char" id="44"></td>
                <td><button onclick="readAloud(4)">ðŸ”‰</button></td>
                <td class="pinyin"></td>
                <td class="def"></td>
              </tr>
            </tbody>
          </table>
          <button id="start">Start</button>
          <button id="check">Check</button>
          <button id="toggle_pinyin" onclick="toggle_column('pinyin', 'toggle_pinyin')">Hide pinyin</button>
          <button id="toggle_defs" onclick="toggle_column('def', 'toggle_defs')">Hide definitions</button>
          <p id="result"></p>
          <a href="index.html">Back to Home Page</a>
        </div>
      </div>
    </div>
    
    <!--
      Your main logic could go into a dedicated .py file,
      so that the line number in error trace would correctly map into your .py file.
      Alternatively, your logic could stay in this html file,
      so that your end user would have one less file to download, thus slightly faster.

      It is important to remember that all text/python scripts are loaded and run
      in order AFTER all the javascript scripts.
      You cannot interleave python/javascript scripts and expect them to run in order.
    -->
    <script type="text/python" src="main.py"></script>


    <!-- Boilerplate code starts from here -->

    <!-- This part is only needed when debugging in raw Android browser.
    <script src="https://code.hnldesign.nl/hnl.mobileConsole.1.3.js"></script>
    <script type="text/javascript">if (!mobileConsole.status.initialized) {mobileConsole.init();}</script>
    -->

    <!-- Load the javascript loader functions.
         When brython is done initializing everything,
         it emits a signal "brython_done" that a handler in loader.js
         captures and removes the loading blocker.
     -->
    <script src="loader.js"></script>
    <script type="text/javascript"> start_loader("Loading System...") </script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3/brython.min.js"></script>

    <script type="text/javascript"> update_loader_message("Loading Standard Library...") </script>
    <script src="https://cdn.jsdelivr.net/npm/brython@3/brython_stdlib.min.js"></script>
    <!-- Use the following two to replace the above CDN, if you want to use not-yet-released Brython code base -->
    <!--<script src="https://raw.githack.com/brython-dev/brython/master/www/src/brython.js"></script>-->
    <!--<script src="https://raw.githack.com/brython-dev/brython/master/www/src/brython_stdlib.js"></script>-->

    <!--
    On the first run, the parsing of your python code could take a few seconds.
    The user will see whatever loader message is on the page when this process begins.
    The css animations from load.js should continue to run during such a period.

    On subsequent runs, the modules it uses will already have been transpiled.
    It will go fast and any message you change will flash quickly.
    -->
    <script type="text/javascript"> update_loader_message("Loading Program Code...") </script>
    <!-- Boilerplate code starts from here -->

    <script>
      window.speechSynthesis.onvoiceschanged = window.speechSynthesis.getVoices;
      const readAloud = function(rowNum) {
        rowNum = rowNum.toString();
        let toSay = "";
        for (let i = 1; i <= 4; i++) {
          toSay = toSay + document.getElementById(rowNum + i.toString()).textContent;
        }
        let utterance = new SpeechSynthesisUtterance(toSay);
        utterance.lang = "zh-CN";
        speechSynthesis.speak(utterance);
      };

      const toggle_column = function(col_class_name, button_id) {
        const cells = document.getElementsByClassName(col_class_name);
        for (var cell of cells) {
          if (cell.style.display === "none") {
            cell.style.display = "";
          } else {
            cell.style.display = "none";
          }
        }
        const button = document.getElementById(button_id);
        if (button.textContent.substring(0, 4) === "Hide") {
          button.textContent = "Show" + button.textContent.substring(4);
        } else {
          button.textContent = "Hide" + button.textContent.substring(4);
        }
      }
    </script>
  </body>
